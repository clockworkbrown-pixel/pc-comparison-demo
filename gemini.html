<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ã‚³ã‚¹ãƒ‘ã®å…ˆç”Ÿ - ç”¨é€”ã§é¸ã¶ã€ã‚ãªãŸå°‚ç”¨ãƒãƒ¼ãƒˆPC</title>
  <style>
    :root{
      --primary: #2563eb; --primary-light: #3b82f6; --primary-dark: #1d4ed8;
      --secondary: #10b981; --secondary-light: #34d399;
      --accent: #f59e0b; --accent-light: #fbbf24;
      --bg: #f8fafc; --card: #ffffff; --card-hover: #f1f5f9;
      --text: #0f172a; --text-muted: #64748b; --text-light: #94a3b8;
      --border: #e2e8f0; --shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
      --gradient-hero: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-card: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(248,250,252,0.9));
    }
    
    *{box-sizing:border-box; margin:0; padding:0}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans JP',sans-serif; background:var(--bg); color:var(--text); line-height:1.6}
    
    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    .hero{background:var(--gradient-hero); color:white; padding:3rem 1rem 2rem; text-align:center; position:relative; overflow:hidden}
    .hero::before{content:''; position:absolute; top:0; left:0; right:0; bottom:0; background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 20"><defs><pattern id="grain" patternUnits="userSpaceOnUse" width="100" height="20"><circle cx="10" cy="10" r="1.5" fill="white" opacity="0.1"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grain)"/></svg>'); opacity:0.3}
    .hero-content{position:relative; z-index:1; max-width:800px; margin:0 auto}
    .hero h1{font-size:clamp(1.8rem, 4vw, 2.5rem); font-weight:800; margin-bottom:0.5rem; text-shadow:0 2px 4px rgba(0,0,0,0.3)}
    .hero .subtitle{font-size:1.1rem; opacity:0.95; margin-bottom:2rem}
    .trust-indicators{display:flex; justify-content:center; gap:2rem; flex-wrap:wrap; margin-top:1.5rem}
    .trust-item{display:flex; align-items:center; gap:0.5rem; font-size:0.9rem; opacity:0.9}
    
    .container{max-width:1200px; margin:0 auto; padding:0 1rem}
    
    /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ */
    .progress-section{background:white; padding:1.5rem 0; box-shadow:var(--shadow)}
    .progress{display:flex; align-items:center; justify-content:center; gap:1rem; flex-wrap:wrap}
    .step{display:flex; align-items:center; gap:0.5rem; padding:0.5rem 1rem; border-radius:2rem; background:var(--card-hover); transition:all 0.3s}
    .step.active{background:var(--primary); color:white; transform:scale(1.05)}
    .step.completed{background:var(--secondary); color:white}
    .step-num{width:2rem; height:2rem; border-radius:50%; background:rgba(255,255,255,0.3); display:flex; align-items:center; justify-content:center; font-weight:700; font-size:0.9rem}
    .step.active .step-num{background:rgba(255,255,255,0.2)}
    .step-arrow{color:var(--text-light); font-size:1.2rem}
    
    /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
    main{padding:2rem 0}
    section{margin-bottom:3rem}
    h2{font-size:1.5rem; font-weight:700; margin-bottom:1.5rem; color:var(--text)}
    
    /* ç”¨é€”é¸æŠ */
    .use-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(280px, 1fr)); gap:1.5rem; margin-top:1rem}
    .use-card{
      background:var(--card); border-radius:1rem; padding:1.5rem; cursor:pointer; 
      border:2px solid var(--border); transition:all 0.3s ease;
      background:var(--gradient-card); backdrop-filter:blur(10px);
      position:relative; overflow:hidden;
    }
    .use-card::before{
      content:''; position:absolute; top:0; left:0; right:0; height:4px; 
      background:linear-gradient(90deg, var(--primary), var(--secondary)); 
      transform:scaleX(0); transition:transform 0.3s; transform-origin:left;
    }
    .use-card:hover, .use-card.selected:hover {
      transform:translateY(-8px); 
      box-shadow:0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
      border-color:var(--primary);
    }
    .use-card.selected {
      border-color:var(--primary);
      background:linear-gradient(135deg, rgba(37,99,235,0.1), rgba(59,130,246,0.05));
    }
    .use-card.selected::before{transform:scaleX(1)}
    .use-icon{font-size:2.5rem; margin-bottom:1rem}
    .use-title{font-weight:700; font-size:1.1rem; margin-bottom:0.5rem; color:var(--text)}
    .use-desc{color:var(--text-muted); font-size:0.9rem; line-height:1.5}
    .use-examples{margin-top:1rem; padding-top:1rem; border-top:1px solid var(--border)}
    .example-tag{display:inline-block; padding:0.25rem 0.75rem; background:rgba(37,99,235,0.1); color:var(--primary); border-radius:1rem; font-size:0.8rem; margin:0.25rem 0.25rem 0 0}
    .confirm-selection-area { text-align: center; margin-top: 2rem; }
    .confirm-btn {
      background: var(--secondary); color: white; border: none; padding: 1rem 2.5rem;
      border-radius: 0.75rem; font-size: 1.1rem; font-weight: 700; cursor: pointer;
      transition: all 0.3s; box-shadow: var(--shadow);
    }
    .confirm-btn:hover { background: var(--secondary-light); transform: translateY(-3px); }
    .confirm-btn:disabled { background: var(--text-light); cursor: not-allowed; }

    /* ã‚¹ãƒšãƒƒã‚¯è¡¨ç¤º */
    .spec-section{background:var(--card); border-radius:1rem; padding:2rem; margin:2rem 0; border:1px solid var(--border)}
    .spec-header{text-align:center; margin-bottom:2rem}
    .spec-title{font-size:1.3rem; font-weight:700; color:var(--primary); margin-bottom:0.5rem}
    .spec-subtitle{color:var(--text-muted)}
    .spec-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1rem; margin-bottom:2rem}
    .spec-item{
      background:linear-gradient(135deg, #f0f9ff, #e0f2fe); 
      padding:1rem; border-radius:0.75rem; text-align:center;
      border:1px solid rgba(59,130,246,0.2);
    }
    .spec-icon{font-size:1.5rem; margin-bottom:0.5rem}
    .spec-label{font-size:0.8rem; color:var(--text-muted); text-transform:uppercase; letter-spacing:0.05em}
    .spec-value{font-weight:700; font-size:1.1rem; color:var(--primary)}
    .why-section{background:rgba(16,185,129,0.05); padding:1.5rem; border-radius:0.75rem; border-left:4px solid var(--secondary)}
    .why-title{font-weight:700; color:var(--secondary); margin-bottom:1rem}
    
    /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
    .filters{background:var(--card); padding:1.5rem; border-radius:1rem; margin-bottom:2rem; border:1px solid var(--border)}
    .filter-grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:1rem; align-items:end}
    .filter-item{display:flex; flex-direction:column; gap:0.5rem}
    .filter-item label{font-size:0.9rem; color:var(--text-muted); font-weight:500}
    .filter-input{padding:0.5rem 0.75rem; border:1px solid var(--border); border-radius:0.5rem; font-size:0.9rem}
    .filter-checkbox{display:flex; align-items:center; gap:0.5rem}
    .apply-btn{
      background:var(--primary); color:white; border:none; padding:0.75rem 1.5rem; 
      border-radius:0.5rem; font-weight:600; cursor:pointer; transition:background 0.3s;
    }
    .apply-btn:hover{background:var(--primary-dark)}
    
    /* è£½å“ãƒªã‚¹ãƒˆ */
    .product-list{display:flex; flex-direction:column; gap:1rem}
    .product{
      background:var(--card); border-radius:1rem; padding:1.5rem; 
      border:1px solid var(--border); transition:all 0.3s;
      display:grid; grid-template-columns: 20px 120px 1fr auto; gap:1.5rem; align-items:start;
    }
    .product:hover{transform:translateY(-2px); box-shadow:var(--shadow)}
    @media(max-width:768px){.product{grid-template-columns:1fr; text-align:center}}
    
    .compare-checkbox-container { display: flex; align-items: center; justify-content: center; height: 100%; }
    .product-image{width:120px; height:80px; background:var(--card-hover); border-radius:0.5rem; display:flex; align-items:center; justify-content:center; color:var(--text-light)}
    .product-info{min-width:0}
    .product-name{font-weight:700; font-size:1rem; margin-bottom:0.5rem; color:var(--text)}
    .product-specs{display:flex; gap:0.5rem; flex-wrap:wrap; margin:0.5rem 0}
    .spec-badge{padding:0.25rem 0.5rem; border-radius:1rem; font-size:0.75rem; font-weight:500}
    .spec-ok{background:rgba(16,185,129,0.1); color:#065f46}
    .spec-warning{background:rgba(245,158,11,0.1); color:#92400e}
    .spec-ng{background:rgba(239,68,68,0.1); color:#991b1b}
    .product-meta{color:var(--text-muted); font-size:0.85rem; margin-top:0.5rem}
    .value-indicator{margin:0.5rem 0; padding:0.5rem; background:rgba(16,185,129,0.05); border-radius:0.5rem; font-size:0.85rem}
    .value-good{color:var(--secondary)}
    .value-average{color:var(--accent)}
    .value-tooltip {
      position: relative; display: inline-block; cursor: help;
      border-bottom: 1px dotted var(--text-muted);
    }
    .value-tooltip .tooltip-text {
      visibility: hidden; width: 250px; background-color: var(--text);
      color: #fff; text-align: center; border-radius: 6px;
      padding: 5px 10px; position: absolute; z-index: 1;
      bottom: 125%; left: 50%; margin-left: -125px;
      opacity: 0; transition: opacity 0.3s; font-size: 0.8rem;
    }
    .value-tooltip:hover .tooltip-text { visibility: visible; opacity: 1; }
    
    .product-price{text-align:right}
    .price{font-size:1.5rem; font-weight:800; color:var(--accent); margin-bottom:0.5rem}
    .buy-btn{
      display:inline-block; padding:0.75rem 1.5rem; 
      background:linear-gradient(135deg, var(--primary), var(--primary-light)); 
      color:white; text-decoration:none; border-radius:0.75rem; font-weight:600;
      transition:all 0.3s; text-align:center;
    }
    .buy-btn:hover{transform:translateY(-2px); box-shadow:0 10px 15px -3px rgba(37,99,235,0.3)}

    /* æ¯”è¼ƒæ©Ÿèƒ½ */
    .compare-fab {
      position: fixed; bottom: 2rem; right: 2rem; z-index: 100;
      background: var(--accent); color: white; border: none;
      width: 4rem; height: 4rem; border-radius: 50%;
      font-size: 1rem; font-weight: 700; cursor: pointer;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.2);
      display: flex; align-items: center; justify-content: center;
      transition: all 0.3s; transform: scale(0);
    }
    .compare-fab.visible { transform: scale(1); }
    .compare-modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); z-index: 998;
      display: none; align-items: center; justify-content: center;
    }
    .compare-modal {
      background: white; padding: 2rem; border-radius: 1rem;
      max-width: 90%; width: 1000px; max-height: 90vh;
      overflow-y: auto; position: relative;
    }
    .compare-modal-close {
      position: absolute; top: 1rem; right: 1rem; font-size: 1.5rem;
      cursor: pointer; color: var(--text-light); border: none; background: none;
    }
    .compare-table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; }
    .compare-table th, .compare-table td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--border); }
    .compare-table th { background: var(--card-hover); }
    .compare-table td { text-align: center; }
    .compare-table tr th:first-child { text-align: left; }
    
    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
    @media(max-width:640px){
      .trust-indicators{gap:1rem}
      .trust-item{font-size:0.8rem}
      .progress{gap:0.5rem}
      .step{padding:0.25rem 0.75rem; font-size:0.9rem}
      .use-grid{grid-template-columns:1fr; gap:1rem}
      .spec-grid{grid-template-columns:repeat(2, 1fr)}
      .filter-grid{grid-template-columns:1fr; gap:1rem}
    }
    
    /* ç©ºçŠ¶æ…‹ */
    .empty-state{text-align:center; padding:3rem 1rem; color:var(--text-muted)}
    .empty-icon{font-size:3rem; margin-bottom:1rem; opacity:0.5}
    
    footer{background:var(--text); color:white; padding:2rem 0; margin-top:4rem; text-align:center}
    .footer-content{max-width:800px; margin:0 auto}
  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-content">
      <h1>ã‚³ã‚¹ãƒ‘ã®å…ˆç”Ÿ</h1>
      <p class="subtitle">ç”¨é€”ã‚’é¸ã¶ã ã‘ã§ã€ã‚ãªãŸã«ãƒ”ãƒƒã‚¿ãƒªã®ãƒãƒ¼ãƒˆPCã‚’ä¾¡æ ¼é †ã«è¡¨ç¤º</p>
      <div class="trust-indicators">
        <div class="trust-item"><span>âœ…</span><span>åˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒ</span></div>
        <div class="trust-item"><span>ğŸ’°</span><span>ã‚³ã‚¹ãƒ‘é‡è¦–ã®å³é¸</span></div>
        <div class="trust-item"><span>ğŸ“Š</span><span>ä¾¡æ ¼å¦¥å½“æ€§ã‚’å¯è¦–åŒ–</span></div>
        <div class="trust-item"><span>ğŸ”„</span><span>æ¯æ—¥ä¾¡æ ¼æ›´æ–°</span></div>
      </div>
    </div>
  </header>

  <div class="progress-section">
    <div class="container">
      <div class="progress">
        <div class="step active" id="step1"><span class="step-num">1</span><span>ç”¨é€”ã‚’é¸æŠ</span></div>
        <span class="step-arrow">â†’</span>
        <div class="step" id="step2"><span class="step-num">2</span><span>æ¨å¥¨ã‚¹ãƒšãƒƒã‚¯ç¢ºèª</span></div>
        <span class="step-arrow">â†’</span>
        <div class="step" id="step3"><span class="step-num">3</span><span>è£½å“ã‚’æ¯”è¼ƒ</span></div>
        <span class="step-arrow">â†’</span>
        <div class="step" id="step4"><span class="step-num">4</span><span>è³¼å…¥</span></div>
      </div>
    </div>
  </div>

  <main class="container">
    <section>
      <h2>â‘  ã¾ãšã€ä¸»ãªç”¨é€”ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</h2>
      <div class="use-grid" id="useGrid">
        </div>
      <div id="confirmSelectionArea" class="confirm-selection-area" style="display:none;">
        <button id="confirmBtn" class="confirm-btn">ã“ã®æ¡ä»¶ã§PCã‚’æ¢ã™</button>
      </div>
    </section>

    <section id="specSection" class="spec-section" style="display:none">
      <div class="spec-header">
        <div class="spec-title" id="specTitle"></div>
        <div class="spec-subtitle">ã‚ãªãŸã®ç”¨é€”ã«æœ€é©åŒ–ã•ã‚ŒãŸã‚¹ãƒšãƒƒã‚¯ã§ã™</div>
      </div>
      <div class="spec-grid" id="specGrid"></div>
      <div class="why-section">
        <div class="why-title">ğŸ’¡ ãªãœã“ã®ã‚¹ãƒšãƒƒã‚¯ãªã®ï¼Ÿ</div>
        <div id="whyExplanation"></div>
      </div>
    </section>

    <section id="filterSection" style="display:none">
      <h2>â‘¢ ã•ã‚‰ã«æ¡ä»¶ã‚’çµã‚Šè¾¼ã‚€ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h2>
      <div class="filters">
        <div class="filter-grid">
          <div class="filter-item">
            <label>ä¾¡æ ¼ä¸Šé™</label>
            <input type="number" id="maxPrice" class="filter-input" placeholder="ä¾‹ï¼š150000">
          </div>
          <div class="filter-item">
            <label>ç”»é¢ã‚µã‚¤ã‚º</label>
            <select id="screenSize" class="filter-input">
              <option value="">æŒ‡å®šãªã—</option>
              <option value="13">13ã‚¤ãƒ³ãƒå°ï¼ˆæŒã¡é‹ã³é‡è¦–ï¼‰</option>
              <option value="14">14ã‚¤ãƒ³ãƒå°ï¼ˆãƒãƒ©ãƒ³ã‚¹å‹ï¼‰</option>
              <option value="15">15ã‚¤ãƒ³ãƒå°ä»¥ä¸Šï¼ˆä½œæ¥­æ€§é‡è¦–ï¼‰</option>
            </select>
          </div>
          <div class="filter-item">
            <label>é‡é‡</label>
            <select id="weight" class="filter-input">
              <option value="">æŒ‡å®šãªã—</option>
              <option value="1.3">1.3kgä»¥ä¸‹ï¼ˆè¶…è»½é‡ï¼‰</option>
              <option value="1.8">1.8kgä»¥ä¸‹ï¼ˆè»½é‡ï¼‰</option>
            </select>
          </div>
          <div class="filter-item">
            <div class="filter-checkbox">
              <input type="checkbox" id="longBattery">
              <label for="longBattery">é•·æ™‚é–“ãƒãƒƒãƒ†ãƒªãƒ¼ï¼ˆ10æ™‚é–“ä»¥ä¸Šï¼‰</label>
            </div>
          </div>
          <div class="filter-item">
            <button class="apply-btn" id="applyFiltersBtn">çµã‚Šè¾¼ã¿å®Ÿè¡Œ</button>
          </div>
        </div>
      </div>
    </section>

    <section id="productSection" style="display:none">
      <h2>â‘£ ã‚ãªãŸã«ãŠã™ã™ã‚ã®è£½å“ï¼ˆä¾¡æ ¼é †ï¼‰</h2>
      <div id="productList" class="product-list"></div>
    </section>
  </main>
  
  <button id="compareFab" class="compare-fab">æ¯”è¼ƒ<br>(<span id="compareCount">0</span>)</button>
  <div id="compareModalOverlay" class="compare-modal-overlay">
    <div id="compareModal" class="compare-modal">
      <button id="compareModalClose" class="compare-modal-close">Ã—</button>
      <h2>è£½å“æ¯”è¼ƒ</h2>
      <div id="compareTableContainer"></div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <p>â€» ã“ã®ã‚µã‚¤ãƒˆã¯ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã§ã™ã€‚ä¾¡æ ¼ãƒ»åœ¨åº«çŠ¶æ³ã¯å¤‰å‹•ã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>
      <p>è³¼å…¥å‰ã«ã¯å¿…ãšè²©å£²ã‚µã‚¤ãƒˆã§æœ€æ–°æƒ…å ±ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
    </div>
  </footer>

  <script>
    'use strict';
    
    // --- ãƒ‡ãƒ¼ã‚¿å®šç¾© ---
    // NOTE: å®Ÿé‹ç”¨ã§ã¯ã€ã“ã‚Œã‚‰ã®ãƒ‡ãƒ¼ã‚¿ã¯å¤–éƒ¨APIã‚„JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰éåŒæœŸã§èª­ã¿è¾¼ã¿ã¾ã™ã€‚
    
    // ç”¨é€”å®šç¾©
    const USECASES = [
      { key: 'basic', icon: 'ğŸ“§', title: 'åŸºæœ¬ä½œæ¥­', desc: 'ãƒ¡ãƒ¼ãƒ«ã€ãƒ–ãƒ©ã‚¦ã‚¸ãƒ³ã‚°ã€æ–‡æ›¸ä½œæˆãŒä¸­å¿ƒ', examples: ['ãƒ¡ãƒ¼ãƒ«ç¢ºèª', 'ãƒãƒƒãƒˆé–²è¦§', 'YouTubeè¦–è´', 'ç°¡å˜ãªæ–‡æ›¸ä½œæˆ'], specs: { cpu: 1, ram: 8, ssd: 256, gpu: false }, why: 'ã‚¦ã‚§ãƒ–ãƒ–ãƒ©ã‚¦ã‚¶ã¨Officeã‚½ãƒ•ãƒˆãŒåŒæ™‚ã«å¿«é©ã«å‹•ä½œã™ã‚‹ãƒ¬ãƒ™ãƒ«ã€‚å‹•ç”»è¦–è´ã‚‚ã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚' },
      { key: 'student', icon: 'ğŸ“', title: 'å­¦ç”Ÿãƒ»æˆæ¥­ç”¨', desc: 'ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æˆæ¥­ã€ç ”ç©¶æ´»å‹•', examples: ['Word/PowerPoint', 'Zoomæˆæ¥­', 'è«–æ–‡èª¿æŸ»', 'å‹•ç”»è¦–è´'], specs: { cpu: 2, ram: 8, ssd: 512, gpu: false }, why: 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æˆæ¥­ä¸­ã«Wordã§è³‡æ–™ã‚’è¦‹ãªãŒã‚‰ãƒ¡ãƒ¢ã‚’å–ã‚‹ç­‰ã€ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯ã«å¯¾å¿œã€‚å®¹é‡ã‚‚ååˆ†ã§ã™ã€‚' },
      { key: 'business', icon: 'ğŸ’¼', title: 'ãƒ“ã‚¸ãƒã‚¹ãƒ»äº‹å‹™', desc: 'Excelåˆ†æã€ä¼šè­°ã€è³‡æ–™ä½œæˆã€ãƒãƒ«ãƒã‚¿ã‚¹ã‚¯', examples: ['è¤‡é›‘ãªExcel', 'Teamsä¼šè­°', 'ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™', 'è¤‡æ•°ã‚¢ãƒ—ãƒªåŒæ™‚ä½¿ç”¨'], specs: { cpu: 2, ram: 16, ssd: 512, gpu: false }, why: 'å¤§ããªExcelãƒ•ã‚¡ã‚¤ãƒ«ã‚„åŒæ™‚ã«å¤šæ•°ã®ã‚¢ãƒ—ãƒªã‚’é–‹ã„ã¦ã‚‚å¿«é©ã€‚ãƒ“ãƒ‡ã‚ªä¼šè­°ã‚‚é«˜å“è³ªã§å‚åŠ ã§ãã¾ã™ã€‚' },
      { key: 'creative', icon: 'ğŸ¨', title: 'è»½ã„åˆ¶ä½œä½œæ¥­', desc: 'å†™çœŸç·¨é›†ã€å‹•ç”»ç·¨é›†ã€ãƒ‡ã‚¶ã‚¤ãƒ³ä½œæ¥­', examples: ['Photoshop', 'Illustrator', 'YouTubeå‹•ç”»ç·¨é›†', 'ã‚¦ã‚§ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³'], specs: { cpu: 3, ram: 16, ssd: 1024, gpu: false }, why: 'å†™çœŸãƒ»å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ã«ã¯é«˜æ€§èƒ½CPUã¨å¤§å®¹é‡SSDãŒå¿…è¦ã€‚ãƒ¡ãƒ¢ãƒªã‚‚å¤šã‚ã§ä½œæ¥­ãŒå¿«é©ã«ãªã‚Šã¾ã™ã€‚' },
      { key: 'programming', icon: 'ğŸ’»', title: 'ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°', desc: 'ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€é–‹ç™ºç’°å¢ƒã€ä»®æƒ³ãƒã‚·ãƒ³', examples: ['Visual Studio Code', 'Docker', 'ä»®æƒ³ç’°å¢ƒ', 'Gitæ“ä½œ'], specs: { cpu: 3, ram: 16, ssd: 512, gpu: false }, why: 'é–‹ç™ºç’°å¢ƒã‚„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‡¦ç†ã«ã¯é«˜æ€§èƒ½CPUãŒå¿…è¦ã€‚è¤‡æ•°ã®é–‹ç™ºãƒ„ãƒ¼ãƒ«ã‚’åŒæ™‚å®Ÿè¡Œã™ã‚‹ãŸã‚ãƒ¡ãƒ¢ãƒªã‚‚é‡è¦ã§ã™ã€‚' },
      { key: 'gaming', icon: 'ğŸ®', title: 'ã‚²ãƒ¼ãƒŸãƒ³ã‚°', desc: 'æœ€æ–°ã‚²ãƒ¼ãƒ ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é…ä¿¡', examples: ['3Dã‚²ãƒ¼ãƒ ', 'ãƒ©ã‚¤ãƒ–é…ä¿¡', 'VR', 'ã‚²ãƒ¼ãƒ éŒ²ç”»'], specs: { cpu: 3, ram: 16, ssd: 1024, gpu: true }, why: 'æœ€æ–°ã®3Dã‚²ãƒ¼ãƒ ã‚’æ¥½ã—ã‚€ã«ã¯å°‚ç”¨GPUï¼ˆã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚«ãƒ¼ãƒ‰ï¼‰ãŒå¿…é ˆã€‚CPUã¨ãƒ¡ãƒ¢ãƒªã‚‚é«˜æ€§èƒ½ãŒå¿…è¦ã§ã™ã€‚' }
    ];

    // CPUãƒ¬ãƒ™ãƒ«å®šç¾© (æ•°å€¤ãŒå¤§ãã„ã»ã©é«˜æ€§èƒ½)
    const CPU_LEVELS = { 1: 'Intel Core i3 / Ryzen 3', 2: 'Intel Core i5 / Ryzen 5', 3: 'Intel Core i7 / Ryzen 7', 4: 'Apple M2/M3' };
    const CPU_SCORES = { 'Intel i3': 1, 'Ryzen 3': 1, 'Intel i5': 2, 'Ryzen 5': 2, 'Apple M2': 3, 'Intel i7': 3, 'Ryzen 7': 3, 'Apple M3': 4 };

    // ã‚µãƒ³ãƒ—ãƒ«è£½å“ãƒ‡ãƒ¼ã‚¿ (NOTE: valueScoreã‚’å‰Šé™¤ã—ã€å‹•çš„è¨ˆç®—ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´)
    const ALL_PRODUCTS = [
      { id: 1, name: 'Lenovo ThinkPad E14 Gen 5', price: 89800, cpu: 'Ryzen 5', ram: 8, ssd: 256, gpu: false, size: 14.0, weight: 1.4, battery: 12, rating: 4.2, reviews: 156 },
      { id: 2, name: 'HP Pavilion 15', price: 119800, cpu: 'Intel i5', ram: 16, ssd: 512, gpu: false, size: 15.6, weight: 1.7, battery: 9, rating: 4.0, reviews: 89 },
      { id: 3, name: 'ASUS VivoBook 14', price: 134800, cpu: 'Ryzen 7', ram: 16, ssd: 512, gpu: false, size: 14.0, weight: 1.4, battery: 11, rating: 4.3, reviews: 203 },
      { id: 4, name: 'Dell Inspiron 15 Gaming', price: 189800, cpu: 'Intel i7', ram: 16, ssd: 1024, gpu: true, size: 15.6, weight: 2.2, battery: 6, rating: 4.1, reviews: 124 },
      { id: 5, name: 'MacBook Air 13"', price: 134800, cpu: 'Apple M2', ram: 8, ssd: 256, gpu: false, size: 13.6, weight: 1.24, battery: 18, rating: 4.6, reviews: 445 },
      { id: 6, name: 'NEC LAVIE N13', price: 159800, cpu: 'Ryzen 7', ram: 16, ssd: 512, gpu: false, size: 13.3, weight: 0.98, battery: 15, rating: 4.5, reviews: 77 },
      { id: 7, name: 'Fujitsu FMV LIFEBOOK', price: 105000, cpu: 'Intel i5', ram: 8, ssd: 512, gpu: false, size: 15.6, weight: 1.9, battery: 8, rating: 3.9, reviews: 112 },
    ];

    // --- ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•° ---
    let combinedUsecase = null;
    let selectedUsecaseKeys = new Set();
    let productsToShow = [];
    let comparisonList = new Set();
    
    // --- DOMè¦ç´  ---
    const useGrid = document.getElementById('useGrid');
    const confirmSelectionArea = document.getElementById('confirmSelectionArea');
    const confirmBtn = document.getElementById('confirmBtn');
    const specSection = document.getElementById('specSection');
    const filterSection = document.getElementById('filterSection');
    const productSection = document.getElementById('productSection');
    const productList = document.getElementById('productList');
    const compareFab = document.getElementById('compareFab');
    const compareCount = document.getElementById('compareCount');
    const compareModalOverlay = document.getElementById('compareModalOverlay');
    const compareTableContainer = document.getElementById('compareTableContainer');

    // --- åˆæœŸåŒ–å‡¦ç† ---
    document.addEventListener('DOMContentLoaded', initialize);

    function initialize() {
      createUsecaseCards();
      setupEventListeners();
    }
    
    function setupEventListeners() {
      confirmBtn.addEventListener('click', handleConfirmSelection);
      document.getElementById('applyFiltersBtn').addEventListener('click', applyFiltersAndRender);
      compareFab.addEventListener('click', showComparisonModal);
      document.getElementById('compareModalClose').addEventListener('click', hideComparisonModal);
      compareModalOverlay.addEventListener('click', (e) => {
        if (e.target === compareModalOverlay) hideComparisonModal();
      });
      productList.addEventListener('change', handleCompareCheckboxChange);
    }
    
    // --- ç”¨é€”é¸æŠãƒ­ã‚¸ãƒƒã‚¯ (è¤‡æ•°é¸æŠå¯¾å¿œ) ---
    function createUsecaseCards() {
      USECASES.forEach(usecase => {
        const card = document.createElement('div');
        card.className = 'use-card';
        card.dataset.key = usecase.key;
        card.innerHTML = `
          <div class="use-icon">${usecase.icon}</div>
          <div class="use-title">${usecase.title}</div>
          <div class="use-desc">${usecase.desc}</div>
          <div class="use-examples">
            ${usecase.examples.map(ex => `<span class="example-tag">${ex}</span>`).join('')}
          </div>
        `;
        card.addEventListener('click', () => toggleUsecaseSelection(usecase.key));
        useGrid.appendChild(card);
      });
    }

    function toggleUsecaseSelection(key) {
      const card = document.querySelector(`.use-card[data-key="${key}"]`);
      if (selectedUsecaseKeys.has(key)) {
        selectedUsecaseKeys.delete(key);
        card.classList.remove('selected');
      } else {
        selectedUsecaseKeys.add(key);
        card.classList.add('selected');
      }
      
      if (selectedUsecaseKeys.size > 0) {
        confirmSelectionArea.style.display = 'block';
      } else {
        confirmSelectionArea.style.display = 'none';
      }
    }

    function handleConfirmSelection() {
      if (selectedUsecaseKeys.size === 0) return;

      const selected = USECASES.filter(u => selectedUsecaseKeys.has(u.key));
      
      const maxCpu = Math.max(...selected.map(u => u.specs.cpu));
      const maxRam = Math.max(...selected.map(u => u.specs.ram));
      const maxSsd = Math.max(...selected.map(u => u.specs.ssd));
      const needsGpu = selected.some(u => u.specs.gpu);
      
      const titles = selected.map(u => u.title).join('ãƒ»');
      const whyText = selected.map(u => u.why).join('\n');

      combinedUsecase = {
        title: titles,
        specs: { cpu: maxCpu, ram: maxRam, ssd: maxSsd, gpu: needsGpu },
        why: whyText
      };

      updateProgress(2);
      showSpecSection();
      applyFiltersAndRender();
      
      specSection.style.display = 'block';
      filterSection.style.display = 'block';
      productSection.style.display = 'block';
      
      setTimeout(() => {
        specSection.scrollIntoView({ behavior: 'smooth' });
      }, 100);
    }

    // --- ã‚¹ãƒšãƒƒã‚¯è¡¨ç¤º ---
    function showSpecSection() {
      const { title, specs, why } = combinedUsecase;
      
      document.getElementById('specTitle').textContent = `${title}ã«æœ€é©ãªã‚¹ãƒšãƒƒã‚¯`;
      document.getElementById('specGrid').innerHTML = `
        <div class="spec-item"><div class="spec-icon">âš™ï¸</div><div class="spec-label">CPU</div><div class="spec-value">${CPU_LEVELS[specs.cpu]}</div></div>
        <div class="spec-item"><div class="spec-icon">ğŸ§ </div><div class="spec-label">ãƒ¡ãƒ¢ãƒª(RAM)</div><div class="spec-value">${specs.ram}GB</div></div>
        <div class="spec-item"><div class="spec-icon">ğŸ’¾</div><div class="spec-label">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸(SSD)</div><div class="spec-value">${specs.ssd >= 1024 ? (specs.ssd/1024)+'TB' : specs.ssd+'GB'}</div></div>
        <div class="spec-item"><div class="spec-icon">ğŸ®</div><div class="spec-label">ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯(GPU)</div><div class="spec-value">${specs.gpu ? 'å°‚ç”¨GPUæ¨å¥¨' : 'å†…è”µGPUã§ååˆ†'}</div></div>
      `;
      document.getElementById('whyExplanation').textContent = why;
    }

    // --- è£½å“ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° & è¡¨ç¤º ---
    function applyFiltersAndRender() {
      const specs = combinedUsecase.specs;
      
      const maxPrice = Number(document.getElementById('maxPrice').value) || Infinity;
      const screenSize = document.getElementById('screenSize').value;
      const weight = Number(document.getElementById('weight').value) || Infinity;
      const longBattery = document.getElementById('longBattery').checked;

      productsToShow = ALL_PRODUCTS.filter(p => {
        // åŸºæœ¬ã‚¹ãƒšãƒƒã‚¯ãƒã‚§ãƒƒã‚¯
        if ((CPU_SCORES[p.cpu] || 0) < specs.cpu) return false;
        if (p.ram < specs.ram) return false;
        if (p.ssd < specs.ssd) return false;
        if (specs.gpu && !p.gpu) return false;
        
        // è¿½åŠ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        if (p.price > maxPrice) return false;
        if (screenSize) {
          if (screenSize === '13' && p.size >= 14) return false;
          if (screenSize === '14' && p.size >= 15) return false;
          if (screenSize === '15' && p.size < 15) return false;
        }
        if (p.weight > weight) return false;
        if (longBattery && p.battery < 10) return false;
        
        return true;
      });
      
      productsToShow.sort((a, b) => a.price - b.price);
      renderProducts();
      updateProgress(3);
    }

    // --- ã‚³ã‚¹ãƒ‘è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ ---
    function calculateValueScore(product) {
      const cpuPoint = (CPU_SCORES[product.cpu] || 0) * 20; // CPUã®æ¯”é‡ã‚’é‡ã
      const ramPoint = product.ram;
      const ssdPoint = product.ssd / 50;
      const gpuPoint = product.gpu ? 30 : 0;
      
      const totalSpecScore = cpuPoint + ramPoint + ssdPoint + gpuPoint + product.battery;
      const score = Math.round((totalSpecScore / product.price) * 50000);
      return Math.min(score, 99); // ã‚¹ã‚³ã‚¢ãŒ100ã‚’è¶…ãˆãªã„ã‚ˆã†ã«èª¿æ•´
    }

    function getValueText(score) {
      if (score >= 85) return 'éå¸¸ã«è‰¯ã„';
      if (score >= 75) return 'è‰¯ã„';
      if (score >= 65) return 'æ™®é€š';
      return 'æ¤œè¨ã®ä½™åœ°ã‚ã‚Š';
    }

    function getValueClass(score) {
      return (score >= 75) ? 'value-good' : 'value-average';
    }

    // --- è£½å“ãƒªã‚¹ãƒˆæç”» ---
    function renderProducts() {
      if (productsToShow.length === 0) {
        productList.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ˜”</div><p>æ¡ä»¶ã«åˆã†è£½å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p><p>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’ç·©ã‚ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„</p></div>`;
        return;
      }
      
      productList.innerHTML = productsToShow.map(p => {
        const valueScore = calculateValueScore(p);
        const isChecked = comparisonList.has(p.id.toString());
        return `
          <div class="product">
            <div class="compare-checkbox-container">
              <input type="checkbox" class="compare-checkbox" data-id="${p.id}" ${isChecked ? 'checked' : ''}>
            </div>
            <div class="product-image">ğŸ’»</div>
            <div class="product-info">
              <div class="product-name">${p.name}</div>
              <div class="product-specs">
                <span class="spec-badge spec-ok">${p.cpu}</span>
                <span class="spec-badge spec-ok">RAM ${p.ram}GB</span>
                <span class="spec-badge spec-ok">SSD ${p.ssd >= 1024 ? (p.ssd/1024)+'TB' : p.ssd+'GB'}</span>
              </div>
              <div class="value-indicator ${getValueClass(valueScore)}">
                ğŸ’° 
                <span class="value-tooltip">
                  ã‚³ã‚¹ãƒ‘è©•ä¾¡: ${getValueText(valueScore)} (${valueScore}ç‚¹)
                  <span class="tooltip-text">æ€§èƒ½(CPU, RAMç­‰)ã‚’ç‚¹æ•°åŒ–ã—ã€ä¾¡æ ¼ã§å‰²ã£ã¦ç®—å‡ºã€‚é«˜ã„ã»ã©ã‚³ã‚¹ãƒ‘ãŒè‰¯ã„ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚</span>
                </span>
              </div>
              <div class="product-meta">
                ğŸ“ ${p.size}ã‚¤ãƒ³ãƒ â€¢ âš–ï¸ ${p.weight}kg â€¢ ğŸ”‹ ${p.battery}æ™‚é–“ â€¢ â­ ${p.rating} (${p.reviews}ä»¶)
              </div>
            </div>
            <div class="product-price">
              <div class="price">Â¥${p.price.toLocaleString()}</div>
              <a href="#" class="buy-btn" onclick="handlePurchase(${p.id}); return false;">è©³ç´°ãƒ»è³¼å…¥ã¸</a>
            </div>
          </div>
        `;
      }).join('');
    }

    // --- æ¯”è¼ƒæ©Ÿèƒ½ãƒ­ã‚¸ãƒƒã‚¯ ---
    function handleCompareCheckboxChange(event) {
      const checkbox = event.target;
      if (!checkbox.classList.contains('compare-checkbox')) return;
      
      const id = checkbox.dataset.id;
      if (checkbox.checked) {
        comparisonList.add(id);
      } else {
        comparisonList.delete(id);
      }
      
      updateCompareFab();
    }
    
    function updateCompareFab() {
      const count = comparisonList.size;
      compareCount.textContent = count;
      if (count >= 2) {
        compareFab.classList.add('visible');
      } else {
        compareFab.classList.remove('visible');
      }
    }

    function showComparisonModal() {
      const productsToCompare = ALL_PRODUCTS.filter(p => comparisonList.has(p.id.toString()));
      if (productsToCompare.length < 2) return;
      
      const headers = productsToCompare.map(p => `<th>${p.name}</th>`).join('');
      const rows = [
        { label: 'ä¾¡æ ¼', key: 'price', format: val => `Â¥${val.toLocaleString()}`},
        { label: 'ã‚³ã‚¹ãƒ‘è©•ä¾¡', key: 'id', format: (id, p) => `${getValueText(calculateValueScore(p))} (${calculateValueScore(p)}ç‚¹)` },
        { label: 'CPU', key: 'cpu' },
        { label: 'ãƒ¡ãƒ¢ãƒª (RAM)', key: 'ram', format: val => `${val} GB` },
        { label: 'ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ (SSD)', key: 'ssd', format: val => `${val >= 1024 ? (val/1024)+'TB' : val+'GB'}` },
        { label: 'ç”»é¢ã‚µã‚¤ã‚º', key: 'size', format: val => `${val}ã‚¤ãƒ³ãƒ` },
        { label: 'é‡é‡', key: 'weight', format: val => `${val} kg` },
        { label: 'ãƒãƒƒãƒ†ãƒªãƒ¼', key: 'battery', format: val => `${val} æ™‚é–“` },
        { label: 'è©•ä¾¡', key: 'rating', format: (val, p) => `â­ ${val} (${p.reviews}ä»¶)` },
      ];

      const tableBody = rows.map(row => `
        <tr>
          <th>${row.label}</th>
          ${productsToCompare.map(p => {
            const value = p[row.key];
            const displayValue = row.format ? row.format(value, p) : value;
            return `<td>${displayValue}</td>`
          }).join('')}
        </tr>
      `).join('');
      
      compareTableContainer.innerHTML = `<table class="compare-table"><thead><tr><th>ã‚¹ãƒšãƒƒã‚¯</th>${headers}</tr></thead><tbody>${tableBody}</tbody></table>`;
      compareModalOverlay.style.display = 'flex';
    }

    function hideComparisonModal() {
      compareModalOverlay.style.display = 'none';
    }

    // --- ãã®ä»– ---
    function handlePurchase(productId) {
      updateProgress(4);
      alert('å®Ÿéš›ã®ã‚µã‚¤ãƒˆã§ã¯ã€ã“ã“ã§å„ECã‚µã‚¤ãƒˆï¼ˆAmazonã€æ¥½å¤©ç­‰ï¼‰ã®å•†å“ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ã¾ã™ã€‚');
    }

    function updateProgress(step) {
      document.querySelectorAll('.step').forEach((stepEl, index) => {
        stepEl.classList.remove('active', 'completed');
        if (index + 1 < step) stepEl.classList.add('completed');
        else if (index + 1 === step) stepEl.classList.add('active');
      });
    }

  </script>
</body>
</html>